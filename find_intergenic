zcat gencode.vM38.annotation.gff3.gz \
| awk '$3~/^(gene|transcript|exon|CDS|five_prime_UTR|three_prime_UTR|start_codon|stop_codon)$/' \
| awk 'BEGIN{OFS="\t"}{print $1, $4-1, $5, ".", ".", $7}' \
> mm10.genes.bed

bedtools sort -i mm10.genes.bed | bedtools merge -i - > merged_genes.bed

# 提取基因组文件中定义的染色体列表
cut -f1 GRCm39.genome.sizes > valid_chromosomes.txt

# 过滤 BED 文件，仅保留基因组文件中存在的染色体
awk 'BEGIN {FS=OFS="\t"} NR==FNR {chrom[$1]; next} $1 in chrom' valid_chromosomes.txt merged_genes.bed > merged_genes_filtered.bed

bedtools sort -i merged_genes_filtered.bed -g GRCm39.genome.sizes > merged_genes_sorted.bed

bedtools complement -i merged_genes_sorted.bed -g GRCm39.genome.sizes > mm10_intergenic.bed

bedtools intersect -a paraclu_1_overlap.bed -b mm10_intergenic.bed  -u > 1_unique_overlap.bed
